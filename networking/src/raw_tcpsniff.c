#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include "../include/hacking.h"

int main() {
	int recv_length;
	int sockfd;
	u_char buffer[9000];

	sockfd = socket(AF_INET, SOCK_RAW, IPPROTO_TCP);
	if (sockfd == -1) {
		perror("Failed to open socket: ");
		return EXIT_FAILURE;
	}

	for (int i = 0; i < 1000; i++) {
		recv_length = recv(sockfd, buffer, 8000, 0);
		printf("Captured a %dB packet.\n", recv_length);
		dump(buffer, recv_length);
	}

	return EXIT_SUCCESS;
}
